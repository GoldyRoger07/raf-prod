import{a as x}from"./chunk-CKSLSD4F.js";import{c as G,d as se,g as le}from"./chunk-TYPBJ4BO.js";import{C as re,a as k,i as ie,j as ne}from"./chunk-EX5FDRWG.js";import{a as C}from"./chunk-HB54646I.js";import{$b as oe,D as P,Db as B,Fb as H,G as b,Gb as J,H as j,Hb as Q,Jb as X,Pb as Y,Ra as A,Tb as Z,Ub as ee,V as f,W as h,Wb as te,X as E,_ as L,a as _,ab as w,ba as v,bb as F,c as M,ea as R,hb as y,ia as n,ib as N,ja as r,jb as z,ka as c,kb as V,mb as T,nb as U,oa as I,pb as q,qb as D,rb as W,ub as K,va as p,vb as $}from"./chunk-IPMCES2K.js";import"./chunk-5TIO4NZJ.js";import"./chunk-KB6NU4VA.js";import"./chunk-KQGH3CXZ.js";import"./chunk-W6UBUTQL.js";import"./chunk-G3CV3VGG.js";import"./chunk-WSXCG4BJ.js";import"./chunk-453ZWRIO.js";import"./chunk-A7ODLDCL.js";import"./chunk-4U6PRYVA.js";import"./chunk-6BZ4INXC.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-6SXTDW4T.js";var S=class{constructor(e="",ce="",t="",o=0){this.type=e,this.contenu=ce,this.titre=t,this.codeError=o}};var ae=(()=>{let e=class e{constructor(t,o,i){this.urlService=t,this.compteService=o,this.router=i,this.auth=j(se),this.authSubject=new M,this.onGetResultSignIn=l=>{let u=G.credentialFromResult(l),Ce=u==null?void 0:u.accessToken,me=l.user,{photoURL:pe,email:ue,displayName:de}=me,a=new x;a.email=ue,a.urlPhotoProfile=pe;let d=de.split(" ");d.length<3?(a.nom=d[1],a.prenom=d[0]):(a.prenom=d.filter((m,g)=>g!=d.length-1).join(" "),a.nom=d[d.length-1],console.log(`Plus de trois nom:
 Nom: ${a.nom}
 Prenom: ${a.prenom}`));let O=localStorage.getItem("idConnection");O&&(a.idConnection=O),this.compteService.connexionAvecGoogle(a).subscribe({next:m=>{localStorage.setItem("token",m.token),localStorage.setItem("idConnection",m.idConnection),(m==null?void 0:m.loginStatus)==="newGoogleUser"?(localStorage.setItem("loginStatus","newGoogleUser"),this.urlService.redirectTo("/raf-prod/modifier/compte")):this.router.navigate(["/raf-prod/accueil"])},error:m=>{let g=new S;g=m.error.message,console.log(g),g||(g=new S("error","Verifye koneksyon entenet ou an")),this.authSubject.next(g)}})}}signIn(){let t=new G;le(this.auth,t).then(this.onGetResultSignIn)}};e.\u0275fac=function(o){return new(o||e)(b(C),b(k),b(w))},e.\u0275prov=P({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();function be(s,e){s&1&&(n(0,"ion-button",15),c(1,"ion-spinner"),r())}function we(s,e){s&1&&(n(0,"ion-button",16)(1,"ion-text"),p(2,"Koneksyon"),r()())}var Ne=(()=>{let e=class e{constructor(t,o,i,l){this.authService=t,this.compteService=o,this.router=i,this.urlService=l,this.formGroup=new V({email:new T("",y.required),password:new T("",y.required)}),this.isLoading=!1,this.isToastOpen=!1,this.toastMessage="",this.subscription=new _,re({closeSharp:ne,closeCircleOutline:ie})}ngOnInit(){this.authService.authSubject.subscribe(t=>{this.showToast(t.contenu,t.type)})}onSubmit(){if(this.formGroup.markAllAsTouched(),!this.formGroup.invalid){this.isLoading=!0;let t=this.formGroup.value,o=new x;o.email=t.email,o.password=t.password;let i=localStorage.getItem("idConnection");i&&(o.idConnection=i),this.subscription.add(this.compteService.login(o).subscribe({next:l=>{this.isLoading=!1,localStorage.setItem("token",l.token),localStorage.setItem("idConnection",l.idConnection),this.formGroup.reset(),this.urlService.redirectTo("/raf-prod/accueil")},error:l=>{this.isLoading=!1;try{let u=l.error.message;this.showToast(u.contenu,u.type)}catch{this.showToast("Verifye koneksyon entenet ou an","error")}}}))}}showToast(t,o,i){this.toastMessage=t,this.isToastOpen=!0,setTimeout(()=>{this.closeToast(),i&&i()},5500)}closeToast(){this.isToastOpen=!1}signWithGoogle(){this.authService.signIn()}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)(h(ae),h(k),h(w),h(C))},e.\u0275cmp=E({type:e,selectors:[["app-login"]],decls:49,vars:7,consts:[[1,"ion-page"],[3,"forceOverscroll"],[1,"center"],[1,"max-content-w"],[3,"fixed"],[1,"ion-justify-content-center"],["size","5"],["src","assets/img/logo.png"],["size","11"],[1,"title"],[1,"sub-title"],["color","primary","routerLink","/inscription"],[3,"submit","formGroup"],["label","Imel","label-placement","floating","placeholder","Antre imel ou","helperText","Antre yon imel ki valid","errorText","Imel lan paka rete vid","formControlName","email","required","true"],["type","password","label","Modpass","label-placement","floating","helperText","Antre on modpass ki valid","errorText","Modpass lan paka rete vid","placeholder","Antre modpass ou","formControlName","password"],["disabled","true","expand","block","type","submit"],["expand","block","type","submit"],["color","primary","routerLink","/forget-password",1,"forget-password-text"],[1,"line-block"],[1,"line"],["color","light",3,"click"],["id","logoGoogle","src","assets/img/logo_google.png"],["color","danger","icon","close-sharp",3,"isOpen","message","duration"]],template:function(o,i){o&1&&(n(0,"div",0)(1,"ion-content",1)(2,"div",2)(3,"div",3)(4,"ion-grid",4)(5,"ion-row",5)(6,"ion-col",6),c(7,"ion-img",7),r()(),n(8,"ion-row",5)(9,"ion-col",8)(10,"div",9),p(11," Konekte ak kont Raf ou "),r()()(),n(12,"ion-row",5)(13,"ion-col",8)(14,"div",10),p(15," Ou poko gen kont Raf? "),n(16,"ion-text",11),p(17,"Enskripsyon"),r()()()(),n(18,"ion-row")(19,"ion-col")(20,"form",12),I("submit",function(){return i.onSubmit()}),n(21,"ion-grid")(22,"ion-row",5)(23,"ion-col"),c(24,"ion-input",13),r()(),n(25,"ion-row",5)(26,"ion-col"),c(27,"ion-input",14),r()(),n(28,"ion-row",5)(29,"ion-col"),L(30,be,2,0,"ion-button",15)(31,we,3,0,"ion-button",16),r()()()()()(),n(32,"ion-row",5)(33,"ion-col",8)(34,"ion-text",17),p(35,"M bliye modpass mw"),r()()(),n(36,"ion-row",5)(37,"ion-col",8)(38,"div",18),c(39,"div",19),p(40," Oubyen avek "),c(41,"div",19),r()()(),n(42,"ion-row",5)(43,"ion-col",8)(44,"ion-button",20),I("click",function(){return i.signWithGoogle()}),c(45,"ion-img",21),n(46,"ion-text"),p(47,"Google"),r()()()()()()(),c(48,"ion-toast",22),r()()),o&2&&(f(),v("forceOverscroll",!1),f(3),v("fixed",!0),f(16),v("formGroup",i.formGroup),f(10),R(i.isLoading?30:31),f(18),v("isOpen",i.isToastOpen)("message",i.toastMessage)("duration",5e3))},dependencies:[te,Z,B,oe,Y,X,H,Q,ee,J,A,K,U,N,z,W,$,q,D,F],styles:["ion-input[_ngcontent-%COMP%]{--ion-color-success: #ff9800}ion-button[_ngcontent-%COMP%]{margin:0;width:100%}.title[_ngcontent-%COMP%]{padding-top:20px;font-weight:700;text-align:center;color:var(--ion-color-dark-tint);font-size:20px}.sub-title[_ngcontent-%COMP%]{color:var(--ion-color-dark-tint);font-size:small;text-align:center}.forget-password-text[_ngcontent-%COMP%]{font-size:small}.line-block[_ngcontent-%COMP%]{padding:10px 0;display:flex;text-wrap:nowrap;align-items:center;font-size:small;gap:10px}.line-block[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{height:1px;width:100%;background:#cfcfcf}#logoGoogle[_ngcontent-%COMP%]{margin-right:10px}"]});let s=e;return s})();export{Ne as LoginPage};
